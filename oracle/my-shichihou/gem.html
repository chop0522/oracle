<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>宝石詳細</title>
  <link rel="stylesheet" href="assets/css/style.css" />
</head>
<body class="pixel-font dot-bg">
  <header class="site-header">
    <div class="header-inner">
      <a href="index.html" class="site-logo">
        <img src="assets/images/icon.png" alt="七宝占術ロゴ" class="logo-img" />
        <span class="site-title">七宝占術</span>
      </a>
      <nav class="main-nav">
        <ul>
          <li><a href="index.html">TOP</a></li>
          <li><a href="about.html">七宝占術とは</a></li>
          <li><a href="service.html">有料サービス</a></li>
          <li><a href="contact.html">お問い合わせ</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="container" id="gemContent">
    <h1>宝石詳細ページ</h1>

    <!-- JSでDBから取得した宝石データを挿入 -->
    <img id="gemIcon" src="" alt="宝石アイコン" style="width:50px; margin-right: 1rem;" />
    <h2 id="gemName">読み込み中...</h2>
    <p><strong>エレメント:</strong> <span id="gemElement"></span></p>
    <img id="mainImage" src="" alt="メインイメージ" style="display:block; margin:1rem 0;" />
    <p id="description" style="white-space: pre-wrap;">...</p>

    <!-- 一覧に戻るリンク(あれば) -->
    <a href="about.html#gem-section" class="cta-button" style="margin-top:1rem; display:inline-block;">一覧に戻る</a>
  </main>

  <footer class="site-footer">
    <div class="footer-inner">
      <p>&copy; 2024 七宝占術. All Rights Reserved.</p>
    </div>
  </footer>

  <script>
    // 1) URLのクエリパラメータから gem_type_id を取得
    const params = new URLSearchParams(location.search);
    const gemTypeId = params.get('id'); 
    // 例: gem.html?id=1 → gemTypeId = "1"

    // 2) APIにアクセスして、gemTypeIdに該当するデータを取得
    async function fetchGemData(id) {
      const url = `http://localhost:3000/api/gems/${id}`;
      // 上記のportはindex.jsのportに合わせる
      const res = await fetch(url);
      if (!res.ok) {
        console.error('Error fetching gem data:', res.status, res.statusText);
        return null;
      }
      return await res.json(); 
    }

    // 3) 取得したデータをHTML要素に反映
    fetchGemData(gemTypeId).then(data => {
      if (data) {
        document.getElementById('gemIcon').src = data.icon_url;
        document.getElementById('gemName').textContent = data.gem_type_name;
        document.getElementById('gemElement').textContent = data.element;
        document.getElementById('mainImage').src = data.main_image_url;
        document.getElementById('description').textContent = data.detail_description;
      } else {
        document.getElementById('gemName').textContent = '宝石情報が見つかりません。';
      }
    });
  </script>
</body>
</html>